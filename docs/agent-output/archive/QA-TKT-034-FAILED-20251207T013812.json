{
  "ticket_id": "TKT-034",
  "ticket_title": "Call Logs Pagination for Performance",
  "branch": "agent/tkt-034",
  "blocked_at": "2025-12-07T01:38:12Z",
  "blocker_type": "qa_failure",
  "summary": "Total count query does not apply active filters, causing incorrect pagination display when filters are used",
  "failures": [
    {
      "category": "acceptance",
      "criterion": "AC4 - Filters work correctly with pagination",
      "expected": "Total count should reflect the filtered result set. When filters are active (agent, status, disposition, pool, duration, country), pagination should show the count of filtered results, not all results.",
      "actual": "Total count query (page.tsx:128-133) only filters by organization_id and created_at. It does NOT apply the agent, status, disposition, pool, minDuration, maxDuration, or country filters that are applied to the main data query (lines 83-120). This causes pagination UI to show incorrect totals like 'Showing 1 to 50 of 500 calls' when only 75 calls match the filters.",
      "evidence": "Code inspection: Total count query at page.tsx:128-133 missing all filter parameters that main query has at lines 83-120. Filters include: params.agent (line 83), params.status (line 89), params.disposition (line 95), params.pool (line 101), params.minDuration (line 108), params.maxDuration (line 111), params.country (line 114)."
    },
    {
      "category": "regression",
      "criterion": "Edge case handling - input validation",
      "expected": "Page and limit parameters should be validated to ensure page >= 1 and limit > 0. Non-numeric inputs should be handled gracefully.",
      "actual": "No validation exists. Negative page numbers result in negative offsets (e.g., page=-1 → offset=-100). Zero limit results in invalid range queries (e.g., limit=0 → range(0,-1)). Non-numeric inputs cause NaN propagation (e.g., page=abc → offset=NaN).",
      "evidence": "Code inspection: page.tsx:123-125 parses params but has no validation checks. parseInt can return NaN, negative values, or zero without any handling."
    }
  ],
  "recommendation": "Apply all filters (agent, status, disposition, pool, duration, country) to the total count query at page.tsx:128-133. Add input validation: if (isNaN(page) || page < 1) page = 1; if (isNaN(limit) || limit <= 0) limit = 50;",
  "dispatch_action": "create_continuation_ticket"
}
